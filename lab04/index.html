<!DOCTYPE html>
<html>

<head>
    <meta name="viewport"
          content="width=device-width, initial-scale=1">
    <meta name="author"
          content="Adam Kowalczyk">
    <meta name="description"
          content="IPM lab04">

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
        }


        .my-li{
            border: 1px solid grey;
            height:2rem;
        }


        .list-container{
            max-width:600px;
            margin:auto;
        }
    </style>

    <script>

        function dragStart(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
            ev.dataTransfer.setData("offsetX", ev.layerX);
            ev.dataTransfer.setData("offsetY", ev.layerY);
        }

        function dragDrop(ev) {
            ev.preventDefault();
            ev.target.appendChild(block);
        }

        window.addEventListener('load', () => {

        })

    </script>
</head>

<body>



    <h1>DRAG AND DROP</h1>
    <div class="list">
        
    </div>
    <div class="list-container">
        
        <ol>
            <li class="draggable my-li"
                draggable="true">audi</li>
            <li class="draggable my-li"
                draggable="true">volkswagen</li>
            <li class="draggable my-li"
                draggable="true">bmw</li>
            <li class="draggable my-li"
                draggable="true">renault</li>
            <li class="draggable my-li"
                draggable="true">peugeot</li>

        </ol>
        <input type="text"
               class="input"
               placeholder="Nowy element" />
        <button type="button" id="add-button" onclick="addNewItem()">Dodaj</button>
    </div>
    

    <script>

        var remove = document.querySelector('.draggable');

        function dragStart(e) {
            dragSrcEl = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        };

        function dragEnter(e) {
            this.classList.add('over');
        }

        function dragLeave(e) {
            e.stopPropagation();
            this.classList.remove('over');
        }

        function dragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function dragDrop(e) {
            if (dragSrcEl != this) {
                dragSrcEl.innerHTML = this.innerHTML;
                this.innerHTML = e.dataTransfer.getData('text/html');
            }
            return false;
        }

        function dragEnd(e) {
            var listItens = document.querySelectorAll('.draggable');
            [].forEach.call(listItens, function (item) {
                item.classList.remove('over');
            });
            this.style.opacity = '1';
        }

        function addEventsDragAndDrop(el) {
            el.addEventListener('dragstart', dragStart, false);
            el.addEventListener('dragenter', dragEnter, false);
            el.addEventListener('dragover', dragOver, false);
            el.addEventListener('dragleave', dragLeave, false);
            el.addEventListener('drop', dragDrop, false);
            el.addEventListener('dragend', dragEnd, false);
        }

        var listItens = document.querySelectorAll('.draggable');
        [].forEach.call(listItens, function (item) {
            addEventsDragAndDrop(item);
        });

        function addNewItem() {
            var newItem = document.querySelector('.input').value;
            if (newItem != '') {
                document.querySelector('.input').value = '';


                var li = document.createElement('li');
                var attr = document.createAttribute('draggable');
                var ul = document.querySelector('ol');


                li.className = 'draggable';
                attr.value = 'true';
                li.setAttributeNode(attr);
                li.appendChild(document.createTextNode(newItem));
                ul.appendChild(li);
                addEventsDragAndDrop(li);
            }
        }


    </script>



</body>

</html>